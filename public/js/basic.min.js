var intervalVotes=false;var oldVoteData=null;var voting_over_interval_multiplier=1;var SHOW_DETAILS_MIN_WIDTH=800;var width_device=(window.innerWidth>0)?window.innerWidth:screen.width;function vote_helper(c,a,b){$.ajax({type:"POST",url:"/vote.php",data:{action:c,identifier:a,note:b,date:$("#date").val()},dataType:"json",success:function(d){if(intervalVotes){clearInterval(intervalVotes)}if(typeof d.voting_over!="undefined"&&d.voting_over||!d||typeof d.alert!="undefined"){voting_over_interval_multiplier+=0.1}else{voting_over_interval_multiplier=1}intervalVotes=setInterval(function(){vote_get()},Math.floor(5000*voting_over_interval_multiplier));if(typeof JSON!="undefined"&&JSON.stringify(oldVoteData)==JSON.stringify(d)&&typeof d.alert=="undefined"){return}if(typeof d.alert!="undefined"){alert(d.alert)}else{if(typeof d.html!="undefined"){$("#dialog_ajax_data").html(d.html)}else{if(intervalVotes){$("#dialog_vote_summary").hide()}}}oldVoteData=d},error:function(){alert("Fehler beim Abfragen/Setzen der Votes.")}})}function vote_up(a){vote_helper("vote_up",a,null,0);$("#dialog_vote_summary").show();adapt_button_vote_summary_toggle()}function vote_down(a){vote_helper("vote_down",a,null,0);$("#dialog_vote_summary").show();adapt_button_vote_summary_toggle()}function vote_special(a){$("#noteInput").val(a);vote_helper("vote_special",a,null,0);$("#dialog_vote_summary").show();adapt_button_vote_summary_toggle()}function vote_set_note(a){vote_helper("vote_set_note",null,a,0);$("#dialog_vote_summary").show();adapt_button_vote_summary_toggle()}function vote_get(){vote_helper("vote_get",null,null,0)}function vote_delete(){$("#noteInput").val("");vote_helper("vote_delete",null,null,0)}function vote_delete_part(a){if(a=="special"){$("#noteInput").val("")}vote_helper("vote_delete_part",a,null,0)}function get_alt_venues(a){$.ajax({type:"GET",url:"/nearplaces.php",data:{action:"nearbysearch"},dataType:"json",success:function(b){if(typeof b.alert!="undefined"){alert(b.alert)}else{return a(b)}},error:function(){alert("Fehler beim Abholen der Restaurants in der NÃ¤he.")}})}function vote_settings_save(){$.ajax({type:"POST",url:"/users.php",data:{action:"user_config_set",name:$("#name").val(),email:$("#email").val(),vote_reminder:$("#vote_reminder").is(":checked"),voted_mail_only:$("#voted_mail_only").is(":checked"),vote_always_show:$("#vote_always_show").is(":checked")},dataType:"json",success:function(a){if(typeof a.alert!="undefined"){alert(a.alert)}},error:function(){alert("Fehler beim Setzen der Vote-Einstellungen.")}})}function adapt_button_vote_summary_toggle(){if($("#dialog_vote_summary").is(":visible")){$("#button_vote_summary_toggle").val("Voting Ausblenden").html("Voting Ausblenden")}else{$("#button_vote_summary_toggle").val("Voting Anzeigen").html("Voting Anzeigen")}}function venue_hide(b){var a=$.cookie("venues_hidden");if(typeof a!="object"){a=new Array()}a.push(b);$.cookie("venues_hidden",a,{expires:31});$("#"+b).hide()}function init_datatables(){$(document).ready(function(){$("#table_stats").dataTable({order:[[4,"desc"]],dom:"<lfpti>",lengthChange:false,searching:true,fnDrawCallback:function(a){$("#table_stats_filter input").attr("type","text").attr("data-type","search");$("#table_stats_filter input").textinput()}});$("#table_stats").show();$("#table_ingredients").dataTable({order:[[2,"desc"]],dom:"<lfpti>",lengthChange:false,searching:false});$("#table_ingredients").show();$("#table_compositions").dataTable({order:[[2,"desc"]],dom:"<lfpti>",lengthChange:false,searching:false});$("#table_compositions").show();$("#loader_stats").hide()})}$(document).ready(function(){$("#loadingContainer").hide();if($("#show_voting").length){vote_get()}$("#date").bind("change",function(){document.location=window.location.protocol+"//"+window.location.host+window.location.pathname+"?date="+$(this).val()});$("#noteForm").submit(function(a){a.preventDefault();$("#setNoteDialog").dialog("close");vote_set_note($("#noteInput").val())});$("#button_vote_summary_toggle").click(function(){var a=$("#dialog_vote_summary");if(a.is(":visible")){a.hide()}else{a.show()}adapt_button_vote_summary_toggle()});if($("#vote_always_show").is(":checked")){$("#dialog_vote_summary").show();setTimeout(function(){adapt_button_vote_summary_toggle()},0)}$("#tabs").on("tabsactivate",function(b,c){if(c.newTab.index()==1){$("#table_voting_alt").hide();$("#div_voting_alt_loader").show();var a=new Array();get_alt_venues(function(d){if($.fn.DataTable.isDataTable("#table_voting_alt")){$("#table_voting_alt").dataTable().fnDestroy()}$("#table_voting_alt").dataTable({data:d,columns:[{title:"Name"},{title:"Distanz"},{title:"Aktionen"}],order:[[1,"asc"]],initComplete:function(f,e){$("#table_voting_alt_wrapper select").selectmenu();$("#table_voting_alt_wrapper input").textinput()},fnDrawCallback:function(e){$("#table_voting_alt_filter input").attr("type","text").attr("data-type","search");$("#table_voting_alt_filter input").textinput();$("#table_voting_alt_wrapper div.ui-link").button({enhanced:true})},dom:"<lfpti>",lengthChange:false,searching:true});$("#div_voting_alt_loader").hide();$("#table_voting_alt").show()},0)}})});